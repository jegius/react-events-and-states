[На главную](../../../README.md)

# Оглавление

1. [Redux-редуктор](#редуктор)
2. [Redux Selectors](#redux-selectors)
3. [Создание и экспорт Redux Store](#`createStore`)

# Redux Actions

Это файлик redux actions. Экспортируется много констант, которые представляют различные типы действий, а также функции экшенов, которые возвращают объект действия с заданными параметрами.

## Список действий:

### `ADD_ITEM`

Тип действия для добавления элемента.

### `SET_START`

Тип действия для установки значения, указывающего, начато ли голосование.

### `SET_ERROR`

Тип действия для установки сообщения об ошибке.

### `SET_ITEMS`

Тип действия для установки списка элементов.

### `SET_USER`

Тип действия для установки текущего пользователя.

### `SET_CAN_VOTE`

Тип действия для указания возможности голосования.

### `SET_SHOW_REGISTRATION`

Тип действия для указания отображается ли регистрация.

## Функции экшенов

Каждая функция экшона принимает один аргумент и возвращает объект, который содержит тип действия и значение этого действия.

Например:

```jsx
export const setError = error => ({
    type: SET_ERROR,
    payload: error
});
```

Функция `setError` принимает параметр `error` и возвращает объект с константой `SET_ERROR` как типом и `error` как `payload`.

Пример использования:

```jsx
import { setError } from './actions';

dispatch(setError('Ошибка при авторизации'));
```

В этом примере вызывается экшн `setError`, который передает сообщение об ошибке в действие и передает его в Redux диспетчер.

# Redux-редуктор `votingReducer.js`

`votingReducer.js` - это Redux-редуктор, который управляет состоянием приложения, связанным с голосованием.

## Initial State

```jsx
const initialState = {
    items: [],
    isStarted: false,
    user: null,
    isCanVote: false,
    isShowRegistration: false,
    error: null,
};
```

`initialState` - это объект, который определяет начальное состояние хранилища. Он содержит следующие свойства:

- `items` - это массив, который содержит элементы, представленные в голосовании.
- `isStarted` - этот флаг определяет, началось ли голосование.
- `user` - содержит информацию о текущем пользователе.
- `isCanVote` - этот флаг указывает, может ли текущий пользователь голосовать.
- `isShowRegistration` - этот флаг указывает, показывается ли пользователю интерфейс регистрации.
- `error` - содержит любые ошибки, которые могли возникнуть.

## Редуктор

`votingReducer` - это функция, которая принимает текущее состояние и выполняет действие, чтобы вернуть новое состояние. Её задача - обрабатывать все изменения состояния, связанные с голосованием.

```jsx
const votingReducer = (state = initialState, action) => {
    ...
};
```

В зависимости от `action.type`, `votingReducer` изменяет различные аспекты состояния.

Если тип действия неизвестен, редуктор вернет текущее состояние без изменений.

```jsx
export default votingReducer;
```

`votingReducer`экспортируется как модуль по умолчанию.

## Пример использования

```jsx
import votingReducer from './votingReducer.js';

const store = createStore(votingReducer);
```

В этом примере `votingReducer` используется для создания Redux хранилища с помощью функции `createStore`.

# Redux Selectors

Здесь перечислены функции селекторов Redux, которые извлекают данные из состояния Redux. Это обычные функции JavaScript, которые принимают состояние Redux и возвращают некоторые данные из него.

# Селекторы

## `selectItems`

Эта функция извлекает массив `items` из состояния хранилища.

## `selectIsStarted`

Возвращает булево значение`isStarted`, которое показывает, началось ли голосование.

## `selectUser`

Возвращает текущего пользователя из состояния Redux.

## `selectShowRegistration`

Возвращает булево значение `isShowRegistration`, которое указывает, показана ли в данный момент регистрация.

## `selectIsCanVote`

Возвращает булево значение `isCanVote`, которое указывает, может ли пользователь голосовать.

## `selectAllVotedForItem`

Принимает хранилище и `itemId` как параметры и возвращает массив пользователей, которые проголосовали за этот элемент.

## `selectVotedCounterForItem`

Принимает хранилище и `itemId` и возвращает количество голосов для данного элемента.

## `isSelected`

Принимает состояние Redux, id элемента и пользователя и проверяет, голосовал ли данный пользователь за этот элемент.

## `allVotes`

Извлекает общее количество голосов все выбранных элементов из состояния Redux.

## `selectPercentByAll`

Принимает состояние Redux и объект элемента и возвращает процент голосов, который набрал этот элемент по отношению ко всем голосам.

# Примечание:

Всегда стоит использовать выборки, поскольку они позволяют изолировать знания о структуре состояния вашего приложения и повышают производительность благодаря встроенной мемоизации.

# Создание Redux Store

В этом файле создается хранилище Redux. Хранилище Redux - это объект, который управляет состоянием вашего приложения в целом.

## `createStore`

Функция `createStore` из библиотеки Redux используется для создания нового хранилища. Эта функция принимает на вход редуктор и, опционально, начальное состояние приложения.

```jsx
import { createStore } from 'redux';
```

## `votingReducer`

`votingReducer` - это редуктор, который был импортирован из другого файла. Редукторы определяют, как будет изменяться состояние приложения в ответ на действия.

```jsx
import votingReducer from './reducer';
```

## `store`

Здесь создается новое хранилище Redux с использованием редуктора `votingReducer`.

```jsx
const store = createStore(votingReducer);
```

## экспорт

Store экспортируется, чтобы он мог быть использован в других частях приложения.

```jsx
export default store;
``` 

## Использовение хранилища

Хранилище Redux обычно используется для обеспечения доступа к состоянию вашего приложения через все компоненты. Для этого вы обычно оборачиваете свое приложение в компонент `Provider` из библиотеки `react-redux`, передавая ему свое хранилище в качестве пропса `store`.

```jsx
import React from 'react';
import { Provider } from 'react-redux';
import store from './store';
import App from './App';

const Root = () => (
  <Provider store={store}>
    <App />
  </Provider>
);
```

Теперь все дочерние компоненты `App` могут подключиться к Redux Store и получить доступ к состоянию приложения или отправить новые действия.